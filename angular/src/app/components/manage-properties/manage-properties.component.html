<div class="bg-gray-50 p-6 font-sans mx-auto">
  <!-- Loading State -->
  <ng-container *ngIf="isLoading; else content">
    <div class="flex items-center justify-center h-64">
      <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-purple-500"></div>
      <p class="text-gray-500 text-lg ml-4">Loading properties...</p>
    </div>
  </ng-container>

  <!-- Content -->
  <ng-template #content>
    <ng-container *ngIf="properties.length > 0; else emptyState">
      <h1 class="text-xl font-semibold mb-6 border-b pb-2">Manage Your Estates</h1>

      <!-- Published Properties -->
      <section class="mb-10">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-2 sm:gap-0">
          <h2 class="text-lg font-semibold">Published:</h2>
          <select class="py-1 px-2 border rounded text-sm w-full sm:w-auto">
            <option>Buy</option>
            <option>Rent</option>
          </select>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
          <!-- Create New Estate Card -->
          <div [routerLink]="['/auth/dashboard/create-property']"
               class="flex items-center justify-center h-48 bg-purple-700 text-white rounded-lg cursor-pointer hover:bg-purple-800 transition-colors">
            <div class="text-center">
              <div class="text-4xl font-bold">＋</div>
              <div class="text-md mt-2 font-bold">Create New Estate</div>
            </div>
          </div>

          <!-- Estate Cards -->
          <div class="bg-white rounded-lg shadow overflow-hidden hover:shadow-md transition-shadow"
               *ngFor="let estate of properties">
            <div class="relative">
              <img [src]="estate.mainImage || '/assets/images/placeholder.jpg'"
                   class="w-full h-32 object-cover"
                   alt="Estate image"/>
              <span class="absolute top-2 right-2 bg-white text-purple-700 text-xs px-2 py-1 rounded shadow">
                {{estate.paymentType || 'Buy'}}
              </span>
            </div>
            <div class="p-3">
              <p class="font-semibold">
                {{estate.price | currency}}
                <span class="ml-2 text-gray-600">{{estate.rooms}} rooms</span>
              </p>
              <p class="text-gray-500 text-xs truncate">{{estate.address}}</p>
              <div class="mt-2 flex flex-wrap gap-1 text-xs">
                <button class="px-2 py-1 bg-gray-100 rounded hover:bg-gray-200">Edit Info</button>
                <button class="px-2 py-1 bg-gray-100 rounded hover:bg-gray-200">Renewal</button>
                <button class="px-2 py-1 bg-red-100 text-red-600 rounded hover:bg-red-200">Delete</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Other Status Sections -->
      <section *ngFor="let status of ['Payment Needed', 'On Hold', 'Rejected']" class="mb-10">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-lg font-semibold">{{status}}:</h2>
          <select class="py-1 px-2 border rounded text-sm">
            <option>Buy</option>
            <option>Rent</option>
          </select>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
          <div class="bg-white rounded-lg shadow overflow-hidden"
               *ngFor="let estate of getPropertiesByStatus(status)">
            <div class="relative">
              <img [src]="estate.mainImage || '/assets/images/placeholder.jpg'"
                   class="w-full h-32 object-cover"
                   alt="Estate image"/>
              <span class="absolute top-2 right-2 bg-white text-purple-700 text-xs px-2 py-1 rounded shadow">
                {{estate.paymentType || 'Buy'}}
              </span>
            </div>
            <div class="p-3">
              <p class="font-semibold">
                {{estate.price | currency}}
                <span class="ml-2 text-gray-600">{{estate.rooms}} rooms</span>
              </p>
              <p class="text-gray-500 text-xs truncate">{{estate.address}}</p>
              <ng-container [ngSwitch]="status">
                <button *ngSwitchCase="'Payment Needed'"
                        class="mt-2 w-full text-xs bg-purple-700 text-white py-1 rounded">
                  Go To Payment
                </button>
                <p *ngSwitchCase="'On Hold'" class="mt-2 text-xs text-center text-gray-500">
                  🕓 Waiting for Approval
                </p>
              </ng-container>
            </div>
          </div>
        </div>
      </section>
    </ng-container>

    <!-- Empty State -->
    <ng-template #emptyState>
      <div class="text-center py-12">
        <div class="mx-auto w-24 h-24 bg-purple-100 rounded-full flex items-center justify-center mb-4">
          <span class="text-purple-700 text-3xl">🏠</span>
        </div>
        <h2 class="text-xl font-semibold mb-2">No Properties Found</h2>
        <p class="text-gray-500 mb-4">You haven't added any properties yet</p>
        <button [routerLink]="['/auth/dashboard/create-property']"
                class="px-4 py-2 bg-purple-700 text-white rounded hover:bg-purple-800 transition-colors">
          Create Your First Property
        </button>
      </div>
    </ng-template>
  </ng-template>
</div>
