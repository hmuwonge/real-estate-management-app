<!-- rental-details.component.html -->

<div class="p-4 max-w-screen-2xl mx-auto text-[#544092]">
  <!-- Top bar -->
  <div class="text-xs text-gray-500 flex justify-between">
    <div>
      <span class="underline cursor-pointer">Back</span>
      <span class="mx-2">|</span>
      Last page name
    </div>
    <div>Last page name</div>
  </div>

  <div *ngIf="!isLoading; else loading">
    <!-- Title -->
    <div class="text-lg font-semibold text-indigo-700 mt-2">
      {{ property?.title }} - {{ property?.governorate?.name }}
    </div>
    <div class="text-sm text-gray-500 mb-4">1434 E Kael St, Mesa, AZ 85203</div>

    <!-- Main Image and Details -->
    <div class="flex flex-col md:flex-row gap-6">
      <div class="w-full md:w-1/2">
        <app-image-slider [images]="imageUrls"></app-image-slider>
      </div>

      <div class="w-full md:w-1/2 space-y-4 h-auto">
        <div class="flex flex-row items-center justify-evenly gap-4">
          <div
            class="text-3xl font-bold text-indigo-600 w-full border-r last:border-r-2 border-gray-400"
          >
            ${{ property?.price }}<span class="text-sm"> per month</span>
          </div>

          <div class="flex items-center gap-4 w-full border-r last:border-r-2 border-gray-400">
            <img
              src="images/rentIcon.svg"
              alt="Favorite"
              class="w-6 h-6 ml-4 cursor-pointer hover:opacity-80 transition-opacity"
            />
            <span class="text-xs text-gray-500">
              <span class="font-semibold">For:</span> Rental</span
            >
          </div>

          <div class="flex items-center ml-4 gap-4 justify-end w-full">
            <img
              src="images/rentIcon.svg"
              alt="Favorite"
              class="w-6 h-6 ml-4 cursor-pointer hover:opacity-80 transition-opacity"
            />
            <span class="text-xs text-gray-500">
              <span class="font-semibold">Owned By:</span> {{ property?.owner?.name }}</span
            >
          </div>
        </div>

        <div class="text-xs text-gray-500">$799,000 / 3bd / 1250 sqft</div>
        <div class="text-sm text-gray-500">545 E Park Avenue, Long Beach, NY 11561</div>

        <div class="text-xs text-gray-500 space-y-1">
          {{ property?.description }}
        </div>

        <div class="grid grid-cols-2 gap-2 mt-4 text-sm">
          <div class="">
            <div class="font-semibold">Unit Space:</div>
            <div class="flex gap-2 text-xs">
              <div>Full Space:</div>
              <div>{{ property?.area }} sqft</div>
            </div>
          </div>
          <div class="">
            <div class="font-semibold">Insurance Payment:</div>
            <div class="flex gap-2 text-xs">
              <div>One Time:</div>
              <div>{{ property?.insurancePayment }}$</div>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-3 gap-2 mt-4 text-sm">
          <div class="bg-gray-100 p-2 rounded-lg">3 BEDS</div>
          <div class="bg-gray-100 p-2 rounded-lg">2 Baths</div>
          <div class="bg-gray-100 p-2 rounded-lg">3 BEDS</div>
          <div class="bg-gray-100 p-2 rounded-lg">2 Baths</div>
        </div>

        <div class="grid grid-cols-3 gap-2 mt-4 text-sm">
          <div class="bg-gray-100 p-2 rounded-lg">3 Windows</div>
          <div class="bg-gray-100 p-2 rounded-lg">3 Windows</div>
          <div class="bg-gray-100 p-2 rounded-lg">3 Windows</div>
        </div>

        <div class="flex gap-2 mt-4">
          <button
            class="flex-1 border border-indigo-600 text-indigo-600 px-4 py-1 text-sm rounded-md"
          >
            Seller Details
          </button>
          <button
            class="flex-1 border border-indigo-600 text-indigo-600 px-4 py-1 text-sm rounded-md"
          >
            <!-- <span (click)="toggleWhatsAppModal()" class="flex items-center gap-2">
              Seller Whatsapp
            </span> -->
            <span *ngIf="showWhatsAppModal; else title">
              {{ property?.owner?.whatsApp }}
            </span>

            <ng-template #title>
              <span class="flex items-center gap-2 cursor-pointer" (click)="toggleWhatsAppModal()">
                Seller Whatsapp
              </span>
            </ng-template>
          </button>
        </div>
      </div>
    </div>

    <!-- Nearby Places -->
    <div class="mt-10">
      <h2 class="text-lg font-semibold">Location and near places:</h2>
      <div class="grid md:grid-cols-6 grid-cols-2 gap-4 mt-4">
        <!-- <app-property-map></app-property-map> -->
        <div
          class="col-span-2 p-2 shadow-md rounded-lg h-48 bg-white flex flex-col items-center justify-center"
        >
          <img src="images/mapMini.svg" class="rounded-lg h-full w-full object-cover" alt="" />
          <p class="text-center">House Location</p>
        </div>

        <div *ngIf="nearbyPlaces.length > 0; else noNearbyPlaces">
          <div
            *ngFor="let place of property?.propertyNearbyPlaces"
            class="bg-white shadow-md p-2 relative rounded-lg flex gap-4 h-48 flex-col items-center justify-center text-center text-sm"
          >
            <img
              src="images/mapMini.svg"
              class="rounded-lg bg-black/50 h-full w-full object-cover"
            />
            <div class="absolute inset-0 flex items-center justify-center text-xs">
              <span class="material-icons bg-white p-2 rounded-md text-indigo-600">{{
                place.icon
              }}</span>
            </div>
            <p class="text-xs">{{ place?.name }}</p>
          </div>
        </div>

        <ng-template #noNearbyPlaces>
          <div
            class="col-span-4 p-2 shadow-md rounded-lg h-48 bg-white flex items-center justify-center"
          >
            <p class="text-gray-500">No nearby places available.</p>
          </div>
        </ng-template>
      </div>
    </div>

    <!-- Unit Features -->
    <div class="mt-10">
      <h2 class="text-lg font-semibold">Unit Features:</h2>
      <div class="flex flex-wrap gap-4 mt-2">
        <div
          class="flex items-center gap-2 bg-purple-100 text-purple-800 px-4 py-2 rounded-lg"
          *ngFor="let feature of property?.features; let i = index; let isLast = last"
        >
          <!-- <span class="material-icons">home</span> -->
          {{ feature.name }}
        </div>
      </div>
    </div>

    <!-- Unit Facilities -->
    <div class="mt-10">
      <h2 class="text-lg font-semibold">Unit Facilities:</h2>
      <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mt-2 text-sm">
        <div
          class="bg-blue-50 shadow-lg rounded-lg p-2 flex text-center"
          *ngFor="let facility of amenities | slice : 0 : 10; let i = index; let isLast = last"
        >
          <div class="flex items-center justify-center p-2 bg-white rounded-md">1</div>

          <div class="flex flex-col items-start mx-2">
            {{ facility }}
            <span class="text-xs text-gray-500 text-start">You Can Add Details Here</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Take a Tour -->
    <div class="mt-10">
      <h2 class="text-lg font-semibold">Take a Tour in the house</h2>

      <div class="relative mt-2 overflow-hidden bg-black/50" style="max-width: 100%; height: 400px">
        <video #tourVideo id="tourVideo" class="w-full h-full object-cover bg-purple/50" controls>
          <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4" />
          Your browser does not support the video tag.
        </video>

        <!-- <button
      (click)="toggleFullscreen()"
      class="absolute top-2 right-2 bg-white rounded-full shadow p-2 z-10"
      title="Fullscreen"
    >
      <span class="material-icons text-indigo-600">fullscreen</span>
    </button> -->
      </div>
    </div>

    <!-- More Homes -->
    <div class="mt-10">
      <h2 class="text-lg font-semibold">More Homes for you:</h2>
      <!--    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">-->
      <!--      <img *ngFor="let home of [1, 2, 3, 4]" src="images/slide{{ home }}.jpg" class="rounded-lg" />-->
      <!--    </div>-->
      <!--    grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6-->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
        <app-property-card
          *ngFor="let property of similarProperties"
          [property]="property"
        ></app-property-card>
      </div>
    </div>
  </div>

  <ng-template #loading>
    <div class="min-h-screen flex flex-col items-center justify-center px-4 sm:px-6 lg:px-8">
      <img [src]="['images/rippleLoader.svg']" alt="Loading" class="w-16 h-16" />
      <p class="text-gray-500 text-lg">Loading Property data...</p>
    </div>
  </ng-template>
</div>
