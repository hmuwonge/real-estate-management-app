<div class="min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8">
  <div class="max-w-7xl mx-auto bg-white rounded-lg shadow-md overflow-hidden">
    <!-- Header -->
    <div class="bg-white px-6 py-4 border-b border-gray-200">
      <h1 class="text-2xl font-bold text-gray-800">Create a new estate</h1>
    </div>

    <!-- Progress Steps -->
    <div class="flex justify-between px-6 py-4 border-b border-gray-200">
      <div class="flex items-center mb-10 mx-auto">
        <div *ngFor="let step of steps; let i = index" class="flex items-center">
          <div *ngIf="i > 0" class="w-10 h-px bg-gray-300 mx-4"></div>
          <div
            class="flex items-center"
            [ngClass]="{
              'text-purple-600': currentStep >= step.number,
              'text-gray-400': currentStep < step.number
            }"
          >
            <div
              [ngClass]="{
                'bg-purple-600 text-white': currentStep >= step.number,
                'border border-gray-400': currentStep < step.number
              }"
              class="w-8 h-8 rounded-full flex items-center justify-center"
            >
              {{ step.number }}
            </div>
            <span class="ml-2">{{ step.title }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Form Content -->
    <form *ngIf="!submitted" [formGroup]="form" (ngSubmit)="onSubmit()" class="p-6">
      <!-- Step 1: Info & Images -->
      <div
        class="grid grid-cols-2 md:grid-cols-2 gap-6"
        *ngIf="currentStep === 1"
        class="space-y-6"
      >
        <!-- Property Info -->
        <div class="bg-white p-6 rounded-lg shadow">
          <label for="propertyName" class="block mb-1 text-sm font-medium">Property Name</label>

          <input
            type="text"
            id="propertyName"
            formControlName="propertyName"
            class="w-full p-2 border rounded mb-4"
          />
          <div
            *ngIf="step1Controls['propertyName'].errors && step1Controls['propertyName'].touched"
            class="text-red-500 text-xs mt-1"
          >
            Property name is required
          </div>

          <label for="description" class="block mb-1 text-sm font-medium">Description</label>
          <textarea
            id="description"
            formControlName="description"
            rows="6"
            class="w-full p-2 border rounded"
          ></textarea>
          <div
            *ngIf="step1Controls['description'].errors && step1Controls['description'].touched"
            class="text-red-500 text-xs mt-1"
          >
            Description is required
          </div>
        </div>

        <!-- Property Images -->
        <div class="bg-white p-6 rounded-lg shadow">
          <label class="block mb-3 text-sm font-medium">Property Images</label>
          <div class="flex space-x-3 overflow-x-auto mb-4">
            <!-- <div *ngFor="let img of property.images" class="relative">
              <img [src]="img.src" class="w-24 h-20 object-cover rounded" />
              <div class="flex justify-between mt-2">
                <button class="text-xs bg-gray-300 px-2 py-1 rounded">â†•</button>
                <button
                  (click)="deleteImage(img)"
                  class="text-xs bg-red-500 text-white px-2 py-1 rounded"
                >
                  Delete
                </button>
              </div>
            </div> -->
          </div>

          <div class="border-2 border-dashed border-purple-300 rounded-lg p-6 text-center">
            <div class="text-purple-600 text-xl mb-2">ðŸ“·</div>
            <p class="text-sm">Drag and drop photos here</p>
            <p class="text-xs text-gray-400">(JPG/PNG/JPEG Files Required)</p>
          </div>
        </div>
      </div>

      <!-- Step 2: Services -->
      <!-- Step 2: Services -->
      <div *ngIf="currentStep === 2" class="space-y-8">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="bg-gray-50 rounded-lg p-4">
            <h3 class="text-xl font-semibold text-gray-800">Unit Details</h3>

            <div class=" p-4 ">
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">New Detail</label>
                <input
                  type="text"
                  formControlName="newDetail"
                  class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border"
                  placeholder="Enter new detail"
                />
              </div>

              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Rooms</label>
                  <input
                    type="number"
                    formControlName="rooms"
                    class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border"
                    placeholder="3"
                  />
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Baths</label>
                  <input
                    type="number"
                    formControlName="baths"
                    class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border"
                    placeholder="1"
                  />
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Area (sqft)</label>
                  <input
                    type="number"
                    formControlName="area"
                    class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border"
                    placeholder="--"
                  />
                </div>
              </div>

              <div class="mt-4 flex space-x-2">
                <div
                  class="bg-white px-3 py-1 rounded-full text-sm font-medium text-gray-700 border border-gray-300"
                >
                  Rooms: {{ form.value.unitDetails?.rooms || '--' }}
                </div>
                <div
                  class="bg-white px-3 py-1 rounded-full text-sm font-medium text-gray-700 border border-gray-300"
                >
                  Baths: {{ form.value.unitDetails?.baths || '--' }}
                </div>
                <div
                  class="bg-white px-3 py-1 rounded-full text-sm font-medium text-gray-700 border border-gray-300"
                >
                  Baths: {{ form.value.unitDetails?.baths || '--' }}
                </div>
              </div>

              <div class="mt-2 flex space-x-2">
                <div
                  class="bg-white px-3 py-1 rounded-full text-sm font-medium text-gray-700 border border-gray-300"
                >
                  Rooms: {{ form.value.unitDetails?.rooms || '--' }}
                </div>
                <div
                  class="bg-white px-3 py-1 rounded-full text-sm font-medium text-gray-700 border border-gray-300"
                >
                  Baths: {{ form.value.unitDetails?.baths || '--' }}
                </div>
              </div>
            </div>

            <h3 class="text-xl font-semibold text-gray-800 mt-6">Unit Facilities</h3>

            <div class="">
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">New Facilities</label>
                <div class="flex space-x-2">
                  <input
                    type="text"
                    formControlName="newFacilities"
                    class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border"
                    placeholder="Enter facility"
                  />
                  <button
                    type="button"
                    (click)="addFacility()"
                    class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                  >
                    Add
                  </button>
                </div>
              </div>

              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                <textarea
                  formControlName="description"
                  rows="2"
                  class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border"
                  placeholder="description here"
                ></textarea>
              </div>

              <div *ngIf="facilities.controls.length > 0" class="space-y-2">
                <div
                  *ngFor="let facility of facilities.controls; let i = index"
                  class="flex items-center space-x-2"
                >
                  <!--              <input-->
                  <!--                type="text"-->
                  <!--                [formControl]="facility"-->
                  <!--                class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border"-->
                  <!--                placeholder="Facility"-->
                  <!--              />-->

                  <input
                    type="text"
                    [formControl]="getFormControl(facility)"
                    class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border"
                    placeholder="Facility"
                  />
                  <button
                    type="button"
                    (click)="removeFacility(i)"
                    class="text-red-500 hover:text-red-700"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-5 w-5"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z"
                        clip-rule="evenodd"
                      />
                    </svg>
                  </button>
                </div>
              </div>

              <div class="mt-4 flex flex-wrap gap-2">
                <div
                  *ngFor="let facility of facilities.value"
                  class="bg-white px-3 py-1 rounded-full text-sm font-medium text-gray-700 border border-gray-300"
                >
                  Facility: {{ facility || '--' }}
                </div>
                <div *ngIf="!facilities.value[0]" class="text-gray-400 text-sm">
                  No facilities added yet
                </div>
              </div>
            </div>
          </div>

          <div>
            <h3 class="text-xl font-semibold text-gray-800 mt-6">Add Features Tags</h3>

            <div class="bg-gray-50 p-4 rounded-lg">
              <div class="flex space-x-2 mb-4">
                <input
                  type="text"
                  class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border"
                  placeholder="Add title here..."
                />
                <button
                  type="button"
                  (click)="addTag()"
                  class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                  [disabled]="featuresTags.length >= 5"
                >
                  Add
                </button>
              </div>

              <div class="flex flex-wrap gap-2 mb-2">
                <div
                  *ngFor="let tag of featuresTags.controls; let i = index"
                  class="flex items-center bg-blue-100 px-3 py-1 rounded-full text-sm font-medium text-blue-800"
                >
                  {{ tag.value || 'New Tag' }}
                  <button
                    type="button"
                    (click)="removeTag(i)"
                    class="ml-1 text-blue-600 hover:text-blue-800"
                  >
                    Ã—
                  </button>
                </div>
                <div *ngIf="featuresTags.length === 0" class="text-gray-400 text-sm">
                  No tags added yet
                </div>
              </div>

              <div class="flex flex-wrap gap-2">
                <div
                  class="bg-white px-3 py-1 rounded-full text-sm font-medium text-gray-700 border border-gray-300"
                >
                  Wifi
                </div>
                <div
                  class="bg-white px-3 py-1 rounded-full text-sm font-medium text-gray-700 border border-gray-300"
                >
                  Nice View
                </div>
                <div
                  class="bg-white px-3 py-1 rounded-full text-sm font-medium text-gray-700 border border-gray-300"
                >
                  Garden
                </div>
              </div>

              <div class="text-xs text-gray-500 mt-2">
                <span *ngIf="featuresTags.length < 5"
                  >You can add up to {{ 5 - featuresTags.length }} more tags</span
                >
                <span *ngIf="featuresTags.length >= 5" class="text-red-500"
                  >Only 5 tags are allowed</span
                >
              </div>
            </div>

            <h3 class="text-xl font-semibold text-gray-800 mt-6">
              Video Tour (MP4 Max - 50MB File)
            </h3>

            <div class="bg-gray-50 p-4 rounded-lg">
              <div class="flex items-center space-x-4">
                <div class="flex-1">
                  <label class="block text-sm font-medium text-gray-700 mb-1">Upload Video</label>
                  <input
                    type="file"
                    accept="video/mp4"
                    (change)="onVideoChange($event)"
                    class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"
                  />
                  <p class="text-xs text-gray-500 mt-1">Supported format: MP4 (max 50MB)</p>
                </div>

                <div
                  *ngIf="form.value.videoTour"
                  class="bg-white p-2 rounded border border-gray-200"
                >
                  <div class="flex items-center">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-6 w-6 text-red-500"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"
                      />
                    </svg>
                    <span class="ml-2 text-sm font-medium">{{
                      form.value.videoTour.name || 'house-tour.mp4'
                    }}</span>
                    <button
                      type="button"
                      (click)="form.patchValue({ videoTour: null })"
                      class="ml-2 text-gray-400 hover:text-gray-600"
                    >
                      Ã—
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 3: Price & Location -->
      <div *ngIf="currentStep === 3" class="space-y-6">
        <div>
          <label for="priceEstimate" class="block text-sm font-medium text-gray-700"
            >Price Estimate</label
          >
          <div class="mt-1 relative rounded-md shadow-sm">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <span class="text-gray-500 sm:text-sm">$</span>
            </div>
            <input
              type="text"
              id="priceEstimate"
              formControlName="priceEstimate"
              class="block w-full pl-7 pr-12 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
              placeholder="786,700"
            />
          </div>
        </div>

        <div>
          <label for="monthlyPayment" class="block text-sm font-medium text-gray-700"
            >Estimated Monthly Payment</label
          >
          <div class="mt-1 relative rounded-md shadow-sm">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <span class="text-gray-500 sm:text-sm">$</span>
            </div>
            <input
              type="text"
              id="monthlyPayment"
              formControlName="monthlyPayment"
              class="block w-full pl-7 pr-12 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
              placeholder="5,324"
            />
            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
              <span class="text-gray-500 sm:text-sm">/mo</span>
            </div>
          </div>
        </div>

        <div>
          <label for="locationDetails" class="block text-sm font-medium text-gray-700"
            >Location Details</label
          >
          <textarea
            id="locationDetails"
            formControlName="locationDetails"
            rows="3"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border"
          ></textarea>
        </div>

        <div class="flex space-x-4">
          <button
            type="button"
            class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
          >
            Get pre-qualified
          </button>
        </div>
      </div>

      <!-- Step 4: Your Plan -->
      <div *ngIf="currentStep === 4" class="space-y-6">
        <h3 class="text-lg font-medium text-gray-900">Select Your Plan</h3>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div
            [ngClass]="{ 'border-blue-500 bg-blue-50': form.value.plan === 'basic' }"
            class="border rounded-md p-4 cursor-pointer"
            (click)="form.patchValue({ plan: 'basic' })"
          >
            <input
              type="radio"
              id="basic"
              formControlName="plan"
              value="basic"
              class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"
            />
            <label for="basic" class="ml-2 block text-sm font-medium text-gray-700">Basic</label>
            <p class="mt-1 text-sm text-gray-500">Essential listing features</p>
          </div>

          <div
            [ngClass]="{ 'border-blue-500 bg-blue-50': form.value.plan === 'premium' }"
            class="border rounded-md p-4 cursor-pointer"
            (click)="form.patchValue({ plan: 'premium' })"
          >
            <input
              type="radio"
              id="premium"
              formControlName="plan"
              value="premium"
              class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"
            />
            <label for="premium" class="ml-2 block text-sm font-medium text-gray-700"
              >Premium</label
            >
            <p class="mt-1 text-sm text-gray-500">Enhanced visibility</p>
          </div>

          <div
            [ngClass]="{ 'border-blue-500 bg-blue-50': form.value.plan === 'enterprise' }"
            class="border rounded-md p-4 cursor-pointer"
            (click)="form.patchValue({ plan: 'enterprise' })"
          >
            <input
              type="radio"
              id="enterprise"
              formControlName="plan"
              value="enterprise"
              class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"
            />
            <label for="enterprise" class="ml-2 block text-sm font-medium text-gray-700"
              >Enterprise</label
            >
            <p class="mt-1 text-sm text-gray-500">Full marketing package</p>
          </div>
        </div>

        <div class="flex items-start">
          <div class="flex items-center h-5">
            <input
              type="checkbox"
              id="terms"
              formControlName="terms"
              class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
            />
          </div>
          <div class="ml-3 text-sm">
            <label for="terms" class="font-medium text-gray-700"
              >I agree to the terms and conditions</label
            >
            <p class="text-gray-500">
              By checking this box, you confirm that all information provided is accurate.
            </p>
          </div>
        </div>
        <div
          *ngIf="form.controls['terms'].errors && form.controls['terms'].touched"
          class="text-red-500 text-xs"
        >
          You must accept the terms and conditions
        </div>
      </div>

      <!-- Navigation Buttons -->
      <div class="flex justify-between pt-6 border-t border-gray-200 mt-6">
        <button
          *ngIf="currentStep > 1"
          type="button"
          (click)="prevStep()"
          class="inline-flex justify-center py-2 px-4 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
        >
          Cancel
        </button>
        <div *ngIf="currentStep < 4" class="ml-auto">
          <button
            type="button"
            (click)="nextStep()"
            class="inline-flex justify-center py-2 px-4 border border-transparent
            shadow-sm text-sm font-medium rounded-md text-white bg-blue-600
             hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2
              focus:ring-blue-500"
          >
            Next

          </button>
        </div>
        <div *ngIf="currentStep === 4" class="ml-auto">
          <button
            type="submit"
            [disabled]="loading || !form.valid"
            class="inline-flex justify-center py-2 px-4 border border-transparent
             shadow-sm text-sm font-medium rounded-md text-white
              bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2
               focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"
          >
            <span *ngIf="!loading">Create Estate</span>
            <span *ngIf="loading" class="flex items-center">
              <svg
                class="animate-spin -ml-1 mr-2 h-4 w-4 text-white"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
              >
                <circle
                  class="opacity-25"
                  cx="12"
                  cy="12"
                  r="10"
                  stroke="currentColor"
                  stroke-width="4"
                ></circle>
                <path
                  class="opacity-75"
                  fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                ></path>
              </svg>
              Processing...
            </span>
          </button>
        </div>
      </div>
    </form>

    <!-- Success Message -->
    <div *ngIf="submitted" class="p-6 text-center">
      <div class="text-green-500 text-5xl mb-4">âœ“</div>
      <h2 class="text-2xl font-bold text-gray-800 mb-2">Estate Created Successfully!</h2>
      <p class="text-gray-600">Your new property listing has been submitted.</p>
      <button
        type="button"
        (click)="currentStep = 1; submitted = false; form.reset()"
        class="mt-4 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
      >
        Create Another Listing
      </button>
    </div>
  </div>
</div>
